@using Talabi.Portal.Services
@inject ILocalizationService LocalizationService
@model Talabi.Portal.Models.CampaignFormViewModel

@{
    ViewData["Title"] = LocalizationService.GetString("CreateNewCampaign");
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>@LocalizationService.GetString("CreateNewCampaign")</h1>
    <a asp-action="Index" class="btn btn-secondary">
        <i class="fas fa-arrow-left me-1"></i> @LocalizationService.GetString("BackToList")
    </a>
</div>

<div class="row">
    <div class="col-md-12">
<form asp-action="Create" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            
            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" id="campaignTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" type="button" role="tab">@LocalizationService.GetString("GeneralInfo")</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="rules-tab" data-bs-toggle="tab" data-bs-target="#rules" type="button" role="tab">@LocalizationService.GetString("AdvancedRules")</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="relations-tab" data-bs-toggle="tab" data-bs-target="#relations" type="button" role="tab">@LocalizationService.GetString("ScopeLocationCategory")</button>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content" id="campaignTabsContent">
                        <!-- General Tab -->
                        <div class="tab-pane fade show active" id="general" role="tabpanel">
                            <div class="mb-3">
                                <label asp-for="Title" class="form-label">@LocalizationService.GetString("CampaignTitle")</label>
                                <input asp-for="Title" class="form-control" placeholder="@LocalizationService.GetString("ExampleCampaignTitle")" required />
                                <span asp-validation-for="Title" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label asp-for="Description" class="form-label">@LocalizationService.GetString("Description")</label>
                                <textarea asp-for="Description" class="form-control" rows="3"></textarea>
                                <span asp-validation-for="Description" class="text-danger"></span>
                            </div>
                            
                            <div class="mb-3">
                                <label asp-for="ImageFile" class="form-label">@LocalizationService.GetString("CampaignImage")</label>
                                <input asp-for="ImageFile" class="form-control" type="file" accept="image/*" />
                                <span asp-validation-for="ImageFile" class="text-danger"></span>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                     <label asp-for="ActionUrl" class="form-label">@LocalizationService.GetString("ActionUrl")</label>
                                    <input asp-for="ActionUrl" class="form-control" placeholder="@LocalizationService.GetString("ExampleActionUrl")" />
                                    <div class="form-text">@LocalizationService.GetString("ActionUrlInfo")</div>
                                    <span asp-validation-for="ActionUrl" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="Priority" class="form-label">@LocalizationService.GetString("Priority")</label>
                                    <input asp-for="Priority" class="form-control" type="number" />
                                    <div class="form-text">@LocalizationService.GetString("PriorityInfo")</div>
                                </div>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label asp-for="DiscountType" class="form-label">@LocalizationService.GetString("DiscountType")</label>
                                    <select asp-for="DiscountType" class="form-select">
                                        <option value="0">@LocalizationService.GetString("Percentage") (%)</option>
                                        <option value="1">@LocalizationService.GetString("FixedAmount")</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="DiscountValue" class="form-label">@LocalizationService.GetString("DiscountValue")</label>
                                    <input asp-for="DiscountValue" class="form-control" type="number" step="0.01" />
                                    <span asp-validation-for="DiscountValue" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label asp-for="StartDate" class="form-label">@LocalizationService.GetString("StartDate")</label>
                                    <input asp-for="StartDate" class="form-control" type="datetime-local" />
                                    <span asp-validation-for="StartDate" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="EndDate" class="form-label">@LocalizationService.GetString("EndDate")</label>
                                    <input asp-for="EndDate" class="form-control" type="datetime-local" />
                                    <span asp-validation-for="EndDate" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mb-3 form-check">
                                <input class="form-check-input" type="checkbox" asp-for="IsActive" />
                                <label class="form-check-label" asp-for="IsActive">@LocalizationService.GetString("IsActive")</label>
                            </div>
                        </div>
                        
                        <!-- Rules Tab -->
                        <div class="tab-pane fade" id="rules" role="tabpanel">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label asp-for="TargetAudience" class="form-label">@LocalizationService.GetString("TargetAudience")</label>
                                    <select asp-for="TargetAudience" class="form-select" asp-items="Html.GetEnumSelectList<Talabi.Core.Enums.TargetAudience>()">
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="VendorType" class="form-label">@LocalizationService.GetString("VendorTypeRestriction")</label>
                                     <select asp-for="VendorType" class="form-select">
                                        <option value="">-- @LocalizationService.GetString("All") --</option>
                                        <option value="1">@LocalizationService.GetString("Restaurant")</option>
                                        <option value="2">@LocalizationService.GetString("Market")</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="MinCartAmount" class="form-label">@LocalizationService.GetString("MinCartAmount")</label>
                                    <input asp-for="MinCartAmount" class="form-control" type="number" step="0.01" />
                                </div>
                            </div>
                             <div class="row mb-3">
                                <div class="col-md-6">
                                    <label asp-for="StartTime" class="form-label">@LocalizationService.GetString("DailyStartTime")</label>
                                    <input asp-for="StartTime" class="form-control" type="time" />
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="EndTime" class="form-label">@LocalizationService.GetString("DailyEndTime")</label>
                                    <input asp-for="EndTime" class="form-control" type="time" />
                                </div>
                            </div>
                        </div>

                        <!-- Relations Tab -->
                        <div class="tab-pane fade" id="relations" role="tabpanel">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label asp-for="SelectedCityIds" class="form-label">@LocalizationService.GetString("ValidCities")</label>
                                    <select asp-for="SelectedCityIds" class="form-select" asp-items="Model.Cities" multiple size="8"></select>
                                    <div class="form-text">@LocalizationService.GetString("MultiSelectInfo")</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label asp-for="SelectedDistrictIds" class="form-label">@LocalizationService.GetString("ValidDistricts")</label>
                                    <select asp-for="SelectedDistrictIds" class="form-select" asp-items="Model.Districts" multiple size="8"></select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label asp-for="SelectedCategoryIds" class="form-label">@LocalizationService.GetString("ValidCategories")</label>
                                    <select asp-for="SelectedCategoryIds" class="form-select" asp-items="Model.Categories" multiple size="8"></select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label asp-for="SelectedProductIds" class="form-label">@LocalizationService.GetString("ValidProducts")</label>
                                    <select asp-for="SelectedProductIds" class="form-select" asp-items="Model.Products" multiple size="8"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <button type="submit" class="btn btn-primary">@LocalizationService.GetString("Save")</button>
                </div>
            </div>
        </form>
    </div>
</div>
